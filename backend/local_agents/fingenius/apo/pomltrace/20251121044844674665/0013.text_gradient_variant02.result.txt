===== human =====

# Role

You are a prompt engineer.

# Task

Analyze where the current prompt failed to elicit the right mechanism.

# Current Prompt Template

æ ¹æ®å½“å‰çŠ¶æ€ `{{current_stage}}` å’Œå·²æ”¶é›†æ•°æ® `{{collected_data}}`ï¼Œåˆ¤æ–­å“ªäº›æµç¨‹å·²ç»æ‰§è¡Œå®Œæ¯•ï¼Œç›´æ¥æ‰§è¡Œä¸‹ä¸€ä¸ªæµç¨‹ã€‚å¦‚æœæµç¨‹å‰é¢å·²ç»æ‰§è¡Œè¿‡ï¼Œä¸è¦é‡å¤æ‰§è¡Œã€‚

**å·¥ä½œæµç¨‹è§„åˆ™**ï¼š

1. **æ•°æ®æ”¶é›†é˜¶æ®µ**ï¼š  
   - å…è®¸ä½¿ç”¨ `æ•°æ®æ”¶é›†å·¥å…·`ï¼Œ**ç¦ç”¨å…¶ä»–æ‰€æœ‰å·¥å…·**ï¼ˆåŒ…æ‹¬ `terminate`ï¼‰ã€‚  
   - æ•°æ®æ”¶é›†å®Œæˆæ¡ä»¶ï¼šå½“ `{{collected_data}}` é•¿åº¦è¶…è¿‡ 200 å­—ç¬¦æ—¶ï¼Œè‡ªåŠ¨è¿›å…¥æ·±åº¦åˆ†æé˜¶æ®µã€‚  
   - è¾“å‡ºæ ¼å¼ï¼š`[æ•°æ®æ”¶é›†ç»“æœ] {{collected_data}} [DATA_COLLECTION_END]`  
   - å¦‚æœå°è¯•è°ƒç”¨ç¦ç”¨å·¥å…·ï¼Œè¿”å›é”™è¯¯ï¼š`âŒ æ•°æ®æ”¶é›†é˜¶æ®µç¦æ­¢è°ƒç”¨ {{tool_name}}ï¼è¯·ä»…ä½¿ç”¨æ•°æ®æ”¶é›†å·¥å…·ã€‚`

2. **æ·±åº¦åˆ†æé˜¶æ®µ**ï¼š  
   - **ç¦ç”¨æ‰€æœ‰å·¥å…·**ï¼ˆåŒ…æ‹¬ `terminate`ï¼‰ï¼Œä»…å…è®¸ç”Ÿæˆåˆ†ææ–‡æœ¬ã€‚  
   - è¿›å…¥æ¡ä»¶ï¼š`{{collected_data}}` é•¿åº¦ â‰¥ 200 å­—ç¬¦ã€‚  
   - è¾“å‡ºæ ¼å¼ï¼š`[æ·±åº¦åˆ†ææŠ¥å‘Š] {{analysis_content}} [ANALYSIS_END]`  
   - å¦‚æœå°è¯•è°ƒç”¨ä»»ä½•å·¥å…·ï¼Œè¿”å›é”™è¯¯ï¼š`âŒ æ·±åº¦åˆ†æé˜¶æ®µç¦æ­¢è°ƒç”¨ä»»ä½•å·¥å…·ï¼è¯·ç”Ÿæˆçº¯æ–‡æœ¬åˆ†ææŠ¥å‘Šã€‚`  
   - åˆ†æå®Œæˆåï¼Œè‡ªåŠ¨è¿›å…¥ç»¼åˆç»“è®ºé˜¶æ®µã€‚

3. **ç»¼åˆç»“è®ºé˜¶æ®µ**ï¼š  
   - å…è®¸è°ƒç”¨ `terminate` ç»“æŸä»»åŠ¡ã€‚  
   - è¿›å…¥æ¡ä»¶ï¼šæ·±åº¦åˆ†æé˜¶æ®µå·²å®Œæˆï¼ˆè¾“å‡ºåŒ…å« `[ANALYSIS_END]`ï¼‰ã€‚  
   - ç»ˆæ­¢æ¡ä»¶ï¼šæœ€ç»ˆç»“è®ºå¿…é¡»åŒ…å«è‡³å°‘ 3 ä¸ªå…³é”®å‘ç°å’Œ 1 æ¡å»ºè®®ã€‚  
   - è¾“å‡ºæ ¼å¼ï¼šè°ƒç”¨ `terminate` å¹¶æäº¤ `[æœ€ç»ˆç»“è®º] {{final_conclusion}}`  
   - å¦‚æœæœªæ»¡è¶³ç»ˆæ­¢æ¡ä»¶ï¼Œè¿”å›é”™è¯¯ï¼š`âŒ ç»“è®ºå¿…é¡»åŒ…å«è‡³å°‘ 3 ä¸ªå…³é”®å‘ç°å’Œ 1 æ¡å»ºè®®æ‰èƒ½ç»“æŸä»»åŠ¡ã€‚`

**æ•°æ®éªŒè¯ä¸é˜¶æ®µè¿‡æ¸¡**ï¼š  
- å¦‚æœ `{{collected_data}}` å­˜åœ¨ä½†é•¿åº¦ < 200 å­—ç¬¦ï¼Œæç¤ºï¼š`âš ï¸ æ•°æ®ä¸å®Œæ•´ï¼Œè¯·ç»§ç»­æ”¶é›†æ•°æ®è‡³ 200 å­—ç¬¦ä»¥ä¸Šã€‚`  
- æ¯ä¸ªé˜¶æ®µç»“æŸæ—¶å¿…é¡»è¾“å‡ºå¯¹åº”çš„ç»“æŸæ ‡è®°ï¼ˆ`[DATA_COLLECTION_END]` / `[ANALYSIS_END]`ï¼‰ä»¥æ˜ç¡®é˜¶æ®µå®Œæˆã€‚  
- é˜¶æ®µè¿‡æ¸¡å‰éœ€ç¡®è®¤ï¼š`ç¡®è®¤{{current_stage}}é˜¶æ®µå·²å®Œæˆï¼Ÿ[YES/NO]`ï¼Œä»…å½“å›ç­”ä¸º YES æ—¶è¿›å…¥ä¸‹ä¸€é˜¶æ®µã€‚

**é”™è¯¯æ¢å¤ä¸å›æ»š**ï¼š  
- å¦‚æœæ£€æµ‹åˆ°é˜¶æ®µè¢«é”™è¯¯è·³è¿‡ï¼Œæ‰§è¡Œå›æ»šï¼šè¾“å‡º `ğŸ”„ æ£€æµ‹åˆ°é˜¶æ®µå¼‚å¸¸ï¼Œå›æ»šè‡³ {{correct_stage}} é˜¶æ®µã€‚` å¹¶é‡ç½® `{{current_stage}}`ã€‚  
- ç¦æ­¢åœ¨éç»¼åˆç»“è®ºé˜¶æ®µè°ƒç”¨ `terminate`ï¼Œå¦åˆ™è¿”å›ï¼š`âŒ è¿è§„æ“ä½œï¼{{current_stage}} é˜¶æ®µç¦æ­¢è°ƒç”¨ terminateï¼è¯·é‡æ–°ç”Ÿæˆçº¯æ–‡æœ¬è¾“å‡ºã€‚`

# Sample Runs with Current Prompt Template

The following are the OpenTelemetry spans collected from the sample runs with the current prompt template. They should contain both prompt, responses and rewards.

## Sample Run #1 Diagnostics

{"rollout_id":"ro-dc24f8bba037","attempt_id":"at-78a0d0d2","sequence_id":1,"trace_id":"b1a8a75b6d34f1ed488817cebba56008","span_id":"3ac4638c58cf80ea","parent_id":"f1103d4002dfa4a8","name":"agentlightning.reward","status":{"status_code":"UNSET","description":null},"attributes":{"reward":0.5481371843836744},"events":[],"links":[],"start_time":1763671942.905433,"end_time":1763671942.905446,"context":{"trace_id":"b1a8a75b6d34f1ed488817cebba56008","span_id":"3ac4638c58cf80ea","is_remote":false,"trace_state":{}},"parent":{"trace_id":"b1a8a75b6d34f1ed488817cebba56008","span_id":"f1103d4002dfa4a8","is_remote":false,"trace_state":{}},"resource":{"attributes":{"service.name":"agentops","agentops.project.id":"dummy","imported_libraries":["logging","multiprocessing"]},"schema_url":""},"kind":"SpanKind.INTERNAL","instrumentation_info":"InstrumentationInfo(agentlightning, , )","instrumentation_scope":"InstrumentationScope(agentlightning, , , {})","sampler":"<opentelemetry.sdk.trace.sampling.ParentBased object at 0x10ac06790>","trace_config":null,"record_exception":true,"set_status_on_exception":true,"limits":"SpanLimits(max_span_attributes=128, max_events_attributes=128, max_link_attributes=128, max_attributes=128, max_events=128, max_links=128, max_attribute_length=None)","lock":"<unlocked _thread.lock object at 0x139d59cc0>"}

## Sample Run #2 Diagnostics

{"rollout_id":"ro-3d2e7656d4e5","attempt_id":"at-3ba81a2d","sequence_id":1,"trace_id":"b1a8a75b6d34f1ed488817cebba56008","span_id":"d29e38f42481032e","parent_id":"f1103d4002dfa4a8","name":"agentlightning.reward","status":{"status_code":"UNSET","description":null},"attributes":{"reward":0.8649884270060016},"events":[],"links":[],"start_time":1763671942.502748,"end_time":1763671942.502761,"context":{"trace_id":"b1a8a75b6d34f1ed488817cebba56008","span_id":"d29e38f42481032e","is_remote":false,"trace_state":{}},"parent":{"trace_id":"b1a8a75b6d34f1ed488817cebba56008","span_id":"f1103d4002dfa4a8","is_remote":false,"trace_state":{}},"resource":{"attributes":{"service.name":"agentops","agentops.project.id":"dummy","imported_libraries":["logging","multiprocessing"]},"schema_url":""},"kind":"SpanKind.INTERNAL","instrumentation_info":"InstrumentationInfo(agentlightning, , )","instrumentation_scope":"InstrumentationScope(agentlightning, , , {})","sampler":"<opentelemetry.sdk.trace.sampling.ParentBased object at 0x10ac06790>","trace_config":null,"record_exception":true,"set_status_on_exception":true,"limits":"SpanLimits(max_span_attributes=128, max_events_attributes=128, max_link_attributes=128, max_attributes=128, max_events=128, max_links=128, max_attribute_length=None)","lock":"<unlocked _thread.lock object at 0x139d8eb00>"}

## Sample Run #3 Diagnostics

{"rollout_id":"ro-cc5c60ace18c","attempt_id":"at-4026096a","sequence_id":1,"trace_id":"b1a8a75b6d34f1ed488817cebba56008","span_id":"9dd5747832df4a0b","parent_id":"f1103d4002dfa4a8","name":"agentlightning.reward","status":{"status_code":"UNSET","description":null},"attributes":{"reward":0.36359036357764907},"events":[],"links":[],"start_time":1763671942.702986,"end_time":1763671942.702999,"context":{"trace_id":"b1a8a75b6d34f1ed488817cebba56008","span_id":"9dd5747832df4a0b","is_remote":false,"trace_state":{}},"parent":{"trace_id":"b1a8a75b6d34f1ed488817cebba56008","span_id":"f1103d4002dfa4a8","is_remote":false,"trace_state":{}},"resource":{"attributes":{"service.name":"agentops","agentops.project.id":"dummy","imported_libraries":["logging","multiprocessing"]},"schema_url":""},"kind":"SpanKind.INTERNAL","instrumentation_info":"InstrumentationInfo(agentlightning, , )","instrumentation_scope":"InstrumentationScope(agentlightning, , , {})","sampler":"<opentelemetry.sdk.trace.sampling.ParentBased object at 0x10ac06790>","trace_config":null,"record_exception":true,"set_status_on_exception":true,"limits":"SpanLimits(max_span_attributes=128, max_events_attributes=128, max_link_attributes=128, max_attributes=128, max_events=128, max_links=128, max_attribute_length=None)","lock":"<unlocked _thread.lock object at 0x139d6ff00>"}

## Sample Run #4 Diagnostics

{"rollout_id":"ro-e3e20d997d26","attempt_id":"at-b649fe27","sequence_id":1,"trace_id":"b1a8a75b6d34f1ed488817cebba56008","span_id":"fab1c0fee0c303eb","parent_id":"f1103d4002dfa4a8","name":"agentlightning.reward","status":{"status_code":"UNSET","description":null},"attributes":{"reward":0.991911524662584},"events":[],"links":[],"start_time":1763671943.097751,"end_time":1763671943.097765,"context":{"trace_id":"b1a8a75b6d34f1ed488817cebba56008","span_id":"fab1c0fee0c303eb","is_remote":false,"trace_state":{}},"parent":{"trace_id":"b1a8a75b6d34f1ed488817cebba56008","span_id":"f1103d4002dfa4a8","is_remote":false,"trace_state":{}},"resource":{"attributes":{"service.name":"agentops","agentops.project.id":"dummy","imported_libraries":["logging","multiprocessing"]},"schema_url":""},"kind":"SpanKind.INTERNAL","instrumentation_info":"InstrumentationInfo(agentlightning, , )","instrumentation_scope":"InstrumentationScope(agentlightning, , , {})","sampler":"<opentelemetry.sdk.trace.sampling.ParentBased object at 0x10ac06790>","trace_config":null,"record_exception":true,"set_status_on_exception":true,"limits":"SpanLimits(max_span_attributes=128, max_events_attributes=128, max_link_attributes=128, max_attributes=128, max_events=128, max_links=128, max_attribute_length=None)","lock":"<unlocked _thread.lock object at 0x139d5b2c0>"}

# Output Format

Write 3-5 short bullets titled 'Critique:' focusing on missing constraints, ordering, or formatting.