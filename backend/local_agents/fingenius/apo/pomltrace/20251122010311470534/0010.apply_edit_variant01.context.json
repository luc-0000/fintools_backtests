{
  "prompt_template": "根据当前状态，判断哪些流程已经执行完毕，直接执行下一个流程。如果流程前面已经执行过，不要重复执行。\n\n**工作流程规则**：\n1. **数据收集阶段**：  \n   - 允许使用 `数据收集工具`，**禁用其他所有工具**（包括 `terminate`）。  \n   - 指令示例：  \n     > \"当前仅允许使用数据收集工具，禁止调用任何其他工具。输出格式：`[数据收集结果]`\"\n\n2. **深度分析阶段**：  \n   - **禁用所有工具**（包括 `terminate`），仅允许生成分析文本。  \n   - 指令示例：  \n     > \"当前处于深度分析阶段，禁止调用任何工具。请基于数据生成专业分析报告，不要解释思考过程。\"\n\n3. **综合结论阶段**：  \n   - 允许调用 `terminate` 结束任务。  \n   - 指令示例：  \n     > \"分析完成后，调用 `terminate` 工具提交最终结论。\"\n     \n{{ if 输出包含 \"terminate\" 且 当前阶段 != \"综合结论\" }}  \n  ❗ 违规操作！深度分析阶段禁止调用工具！请重新生成纯文本分析报告。  \n{{ end }}\n\n重要提示：如果状态中已经含有收集的数据，不要重复收集，进入下一个流程！\n\n**状态输入**：  \n当前阶段由输入变量 `{当前阶段}` 明确指定，其值为 \"数据收集\"、\"深度分析\" 或 \"综合结论\"。请严格依据 `{当前阶段}` 的值执行相应流程。",
  "critique": "Based on the provided experiments and their low final rewards (all below 0.31), here is a critique and specific, testable improvements:\n\n**Critique & Improvements:**\n\n*   **Ambiguous Stage Transition Logic:** The prompt relies on the agent correctly interpreting the state to skip stages, but the logic \"如果状态中已经含有收集的数据，不要重复收集\" is vague. The agent may struggle to identify what constitutes \"already collected data\" from the state input.\n    *   **Testable Change:** Replace the implicit transition logic with an explicit, rule-based trigger. For example: \"**流程切换规则**: 仅当 `{当前阶段}` 变量改变时，才切换到对应流程。在同一阶段内，禁止重复执行已完成的动作（如重复收集数据）。\"\n\n*   **Weak Enforcement of Tool Restrictions:** The conditional check `{{ if 输出包含 \"terminate\" 且 当前阶段 != \"综合结论\" }}` is too narrow. It only catches one specific tool violation in one specific stage. A general tool-use policy is described in text but not actively enforced by the template's logic.\n    *   **Testable Change:** Implement broader, stage-specific guardrails in the template logic. For example:\n        *   `{{ if 当前阶段 == \"数据收集\" }}` -> Enforce that the output MUST attempt to use the `数据收集工具` and MUST NOT be plain text.\n        *   `{{ if 当前阶段 == \"深度分析\" }}` -> Enforce that the output MUST be plain text and MUST NOT contain any tool-calling syntax (e.g., `[`, `]`, or tool names).\n\n*   **Vague Instruction for \"Depth Analysis\":** The instruction \"禁止调用任何工具。请基于数据生成专业分析报告，不要解释思考过程\" is a negative instruction (what *not* to do). It lacks positive guidance on the expected output's structure, content, or length, leading to potentially low-quality reports that are graded poorly.\n    *   **Testable Change:** Provide a positive, structured output format for the analysis stage. For example: \"**深度分析输出格式**: 请按以下结构组织报告：`## 核心发现\\n[列出3-5个主要发现]\\n## 详细解读\\n[对每个发现进行详细阐述]\\n## 初步结论\\n[总结分析形成的初步结论]`\"\n\n*   **Imprecise \"Comprehensive Conclusion\" Stage:** The instruction for the final stage is minimal (\"调用 `terminate` 工具提交最终结论\"). It doesn't specify what the \"final conclusion\" should contain or how it should relate to the prior analysis, risking a generic or irrelevant termination message.\n    *   **Testable Change:** Define a concrete structure for the final conclusion passed to `terminate`. For example: \"**最终结论要求**: 结论必须基于深度分析阶段的结果，并包含以下部分：`1. 总结性陈述；2. 关键证据概要；3. 最终建议或判断`。\""
}