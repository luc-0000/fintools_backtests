{
  "prompt_template": "根据当前状态，判断哪些流程已经执行完毕，直接执行下一个流程。如果流程前面已经执行过，不要重复执行。\n\n**工作流程规则**：\n1. **数据收集阶段**：  \n   - 允许使用 `数据收集工具`，**禁用其他所有工具**（包括 `terminate`）。  \n   - 指令示例：  \n     > \"当前仅允许使用数据收集工具，禁止调用任何其他工具。输出格式：`[数据收集结果]`\"\n\n2. **深度分析阶段**：  \n   - **禁用所有工具**（包括 `terminate`），仅允许生成分析文本。  \n   - 分析报告必须包含明确的标题、关键发现和基于数据的专业分析，避免解释思考过程。  \n   - 指令示例：  \n     > \"当前处于深度分析阶段，禁止调用任何工具。请基于数据生成包含标题和关键发现的专业分析报告。\"\n\n3. **综合结论阶段**：  \n   - 允许调用 `terminate` 结束任务。  \n   - 指令示例：  \n     > \"分析完成后，调用 `terminate` 工具提交最终结论。\"\n     \n{{ if 输出包含 \"terminate\" 且 当前阶段 != \"综合结论\" }}  \n  ❗ 违规操作！深度分析阶段禁止调用工具！请重新生成纯文本分析报告。  \n{{ end }}\n\n重要提示：如果状态中已经含有收集的数据，不要重复收集，进入下一个流程！",
  "critique": "Based on the experiments and the original prompt template, here are specific critiques and testable improvements:\n\n- **Add explicit stage transition logic** - The prompt should include clear conditions for moving between stages (e.g., \"If data collection results exist, immediately proceed to analysis stage\") rather than relying on implicit understanding\n\n- **Define concrete output validation rules** - Instead of generic format examples, specify exact validation patterns like:\n  - Data collection stage: `^\\[数据收集结果\\]: .+` (must match regex pattern)\n  - Analysis stage: Must contain \"## 分析报告\" header and \"### 关键发现\" subsection\n  - Conclusion stage: Must contain `terminate` call with specific parameter structure\n\n- **Implement stage tracking variables** - Add explicit state tracking: `{{当前阶段}} = \"数据收集\" | \"深度分析\" | \"综合结论\"` that gets updated based on completion criteria\n\n- **Strengthen tool restriction enforcement** - Replace generic warnings with hard constraints:\n  ```\n  {{ if 当前阶段 == \"数据收集\" && 工具调用 != \"数据收集工具\" }}\n  错误：当前阶段仅允许数据收集工具！请重新执行。\n  {{ end }}\n  ```\n\n- **Add completion verification checks** - Before stage transitions, verify outputs meet minimum requirements:\n  - Data collection: Must contain at least 3 distinct data points\n  - Analysis: Must contain at least 2 key findings with supporting data references\n  - Conclusion: Must reference both data and analysis findings\n\n- **Improve error recovery guidance** - Provide specific retry instructions for each violation type rather than generic \"re-generate\" messages\n\n- **Optimize output formatting consistency** - Standardize markdown formatting across all stages to reduce parsing variability during evaluation"
}