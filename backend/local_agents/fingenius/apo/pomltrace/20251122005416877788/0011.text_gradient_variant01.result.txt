===== human =====

You optimize a prompt template.

# Original Prompt Template

根据当前状态判断当前阶段，直接执行对应阶段的流程。如果流程前面已经执行过，不要重复执行。

**状态变量定义**：
- `current_phase`：当前阶段，取值为 `数据收集`、`深度分析` 或 `综合结论`
- `collected_data`：已收集的数据内容（若不为空表示数据收集已完成）
- `analysis_report`：已生成的分析报告内容（若不为空表示深度分析已完成）

**阶段执行规则**：

1. **数据收集阶段**（当 `collected_data` 为空时进入此阶段）：
   - 允许使用 `数据收集工具`，**禁用其他所有工具**（包括 `terminate`）。
   - 输出格式必须为：`[数据收集结果]`，并将结果保存至 `collected_data`
   - 指令示例：
     > "当前仅允许使用数据收集工具，禁止调用任何其他工具。输出格式：`[数据收集结果]`"

2. **深度分析阶段**（当 `collected_data` 不为空且 `analysis_report` 为空时进入此阶段）：
   - **禁用所有工具**（包括 `terminate`），仅允许生成纯文本分析报告。
   - 分析报告应包含：数据解读、趋势分析、关键发现，字数限制在 300-500 字。
   - 指令示例：
     > "当前处于深度分析阶段，禁止调用任何工具。请基于 `collected_data` 生成专业分析报告，不要解释思考过程。"

3. **综合结论阶段**（当 `analysis_report` 不为空时进入此阶段）：
   - 允许调用 `terminate` 结束任务。
   - 输出格式必须为：`[最终结论]`，并调用 `terminate` 工具提交
   - 指令示例：
     > "分析完成后，调用 `terminate` 工具提交最终结论。"

**状态转换逻辑**：
- 当 `collected_data` 从空变为非空时，自动进入深度分析阶段
- 当 `analysis_report` 从空变为非空时，自动进入综合结论阶段
- 如果 `collected_data` 已存在，跳过数据收集阶段
- 如果 `analysis_report` 已存在，跳过深度分析阶段

{{ if 输出包含 "terminate" 且 current_phase != "综合结论" }}  
❗ 违规操作！当前阶段禁止调用工具！请重新生成纯文本分析报告。  
{{ end }}

重要提示：基于状态变量判断当前阶段，避免重复执行已完成流程！

# Experiments with Original Prompt Template

## Experiment 1

This experiment has succeeded. It gets a final reward: 0.9281440453692317

### Rollout Traces (Chat Messages, Grader Requests included)

[]

## Experiment 2

This experiment has succeeded. It gets a final reward: 0.38308847776702926

### Rollout Traces (Chat Messages, Grader Requests included)

[]

## Experiment 3

This experiment has succeeded. It gets a final reward: 0.45796943693197245

### Rollout Traces (Chat Messages, Grader Requests included)

[]

## Experiment 4

This experiment has succeeded. It gets a final reward: 0.31298129707387556

### Rollout Traces (Chat Messages, Grader Requests included)

[]

# Your Task

Produce a brief critique listing specific causes for the error or ways to raise reward next time. Return a bullet list with concrete, testable changes (format, constraints, ordering, definitions).